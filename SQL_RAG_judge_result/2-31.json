[
    {
        "DB": "ai_database_dev",
        "Q": "列出2024年各月使用最多的前五个飞机型号，并提供环比变化。",
        "A": [
            [
                "2024-02",
                "995197",
                15177,
                14793,
                "2.60%"
            ],
            [
                "2024-02",
                "719597",
                14602,
                13420,
                "8.81%"
            ],
            [
                "2024-02",
                "449833",
                12496,
                12245,
                "2.05%"
            ],
            [
                "2024-02",
                "444718",
                11508,
                10636,
                "8.20%"
            ],
            [
                "2024-02",
                "801899",
                8981,
                8242,
                "8.97%"
            ],
            [
                "2024-03",
                "995197",
                17105,
                15177,
                "12.70%"
            ],
            [
                "2024-03",
                "719597",
                16127,
                14602,
                "10.44%"
            ],
            [
                "2024-03",
                "449833",
                13076,
                12496,
                "4.64%"
            ],
            [
                "2024-03",
                "444718",
                12369,
                11508,
                "7.48%"
            ],
            [
                "2024-03",
                "801899",
                9550,
                8981,
                "6.34%"
            ],
            [
                "2024-04",
                "995197",
                16882,
                17105,
                "-1.30%"
            ],
            [
                "2024-04",
                "719597",
                16157,
                16127,
                "0.19%"
            ],
            [
                "2024-04",
                "449833",
                13571,
                13076,
                "3.79%"
            ],
            [
                "2024-04",
                "444718",
                12242,
                12369,
                "-1.03%"
            ],
            [
                "2024-04",
                "801899",
                8939,
                9550,
                "-6.40%"
            ],
            [
                "2024-05",
                "995197",
                17636,
                16882,
                "4.47%"
            ],
            [
                "2024-05",
                "719597",
                17285,
                16157,
                "6.98%"
            ],
            [
                "2024-05",
                "449833",
                14129,
                13571,
                "4.11%"
            ],
            [
                "2024-05",
                "444718",
                13789,
                12242,
                "12.64%"
            ],
            [
                "2024-05",
                "801899",
                9647,
                8939,
                "7.92%"
            ],
            [
                "2024-06",
                "995197",
                16028,
                17636,
                "-9.12%"
            ],
            [
                "2024-06",
                "719597",
                15700,
                17285,
                "-9.17%"
            ],
            [
                "2024-06",
                "449833",
                14130,
                14129,
                "0.01%"
            ],
            [
                "2024-06",
                "444718",
                12855,
                13789,
                "-6.77%"
            ],
            [
                "2024-06",
                "801899",
                9060,
                9647,
                "-6.08%"
            ],
            [
                "2024-07",
                "995197",
                16290,
                16028,
                "1.63%"
            ],
            [
                "2024-07",
                "719597",
                16078,
                15700,
                "2.41%"
            ],
            [
                "2024-07",
                "449833",
                15086,
                14130,
                "6.77%"
            ],
            [
                "2024-07",
                "444718",
                13066,
                12855,
                "1.64%"
            ],
            [
                "2024-07",
                "568693",
                9283,
                8413,
                "10.34%"
            ],
            [
                "2024-08",
                "995197",
                16002,
                16290,
                "-1.77%"
            ],
            [
                "2024-08",
                "719597",
                15783,
                16078,
                "-1.83%"
            ],
            [
                "2024-08",
                "449833",
                15412,
                15086,
                "2.16%"
            ],
            [
                "2024-08",
                "444718",
                12510,
                13066,
                "-4.26%"
            ],
            [
                "2024-08",
                "801899",
                8498,
                9003,
                "-5.61%"
            ],
            [
                "2024-09",
                "995197",
                17064,
                16002,
                "6.64%"
            ],
            [
                "2024-09",
                "719597",
                15998,
                15783,
                "1.36%"
            ],
            [
                "2024-09",
                "449833",
                14235,
                15412,
                "-7.64%"
            ],
            [
                "2024-09",
                "444718",
                12434,
                12510,
                "-0.61%"
            ],
            [
                "2024-09",
                "801899",
                8559,
                8498,
                "0.72%"
            ],
            [
                "2024-10",
                "995197",
                12662,
                17064,
                "-25.80%"
            ],
            [
                "2024-10",
                "719597",
                11408,
                15998,
                "-28.69%"
            ],
            [
                "2024-10",
                "449833",
                10599,
                14235,
                "-25.54%"
            ],
            [
                "2024-10",
                "444718",
                8750,
                12434,
                "-29.63%"
            ],
            [
                "2024-10",
                "801899",
                6446,
                8559,
                "-24.69%"
            ]
        ],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                b.aircraft_model_id,\n                COUNT(*) AS num\n        FROM\n                ai_database_dev.zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n        GROUP BY\n                a.date_month,\n                b.aircraft_model_id\n        ),\n        biao_2 AS ( SELECT date_month, aircraft_model_id, num, LAG( num ) OVER ( PARTITION BY aircraft_model_id ORDER BY date_month ) AS last_num FROM biao_1 ),\n        biao_3 AS ( SELECT date_month, aircraft_model_id, num, last_num, ROW_NUMBER() OVER ( PARTITION BY date_month ORDER BY num DESC ) AS rn FROM biao_2 ) SELECT\n        date_month,\n        aircraft_model_id,\n        num,\n        last_num,\n        concat( round(( num - last_num )/ last_num * 100, 2 ), '%' ) AS rate\nFROM\n        biao_3\nWHERE\n        rn <= 5\n        AND last_num IS NOT NULL\nORDER BY\n        date_month,\n        rn;",
        "actual_SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                b.aircraft_model_id,\n                COUNT(*) AS num\n        FROM\n                ai_database_dev.zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n        GROUP BY\n                a.date_month,\n                b.aircraft_model_id\n        ),\n        biao_2 AS ( \n        SELECT \n                date_month, \n                aircraft_model_id, \n                num, \n                LAG(num) OVER (PARTITION BY aircraft_model_id ORDER BY date_month) AS last_num \n        FROM \n                biao_1 \n        ),\n        biao_3 AS ( \n        SELECT \n                date_month, \n                aircraft_model_id, \n                num, \n                last_num, \n                ROW_NUMBER() OVER (PARTITION BY date_month ORDER BY num DESC) AS rn \n        FROM \n                biao_2 \n        ) \nSELECT\n        date_month,\n        aircraft_model_id,\n        num,\n        last_num,\n        CONCAT(ROUND((num - last_num) / last_num * 100, 2), '%') AS rate\nFROM\n        biao_3\nWHERE\n        rn <= 5\n        AND last_num IS NOT NULL\nORDER BY\n        date_month,\n        rn;",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "correct_rate": 100.0,
        "sample_size": 1,
        "correct_count": 1
    }
]