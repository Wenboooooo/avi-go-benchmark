[
    {
        "DB": "data_center_dev",
        "Q": "总结2024年中，Air Pink的总航班数量和飞行排名前三的区域。",
        "A": null,
        "SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1095\" and arr_time>=1699085540917 and arr_time<1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1095\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1095\" AND arr_time >= 1699085540917 AND arr_time < 1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1095\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "DB": "data_center_dev",
        "Q": "总结2024年中，Air Trek Inc.的总航班数量和飞行排名前三的区域。",
        "A": null,
        "SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1100\" and arr_time>=1699085540917 and arr_time<1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1100\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1100\" and arr_time >= 1699085540917 and arr_time < 1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1100\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "DB": "data_center_dev",
        "Q": "总结2024年中，Airstar Inc.的总航班数量和飞行排名前三的区域。",
        "A": null,
        "SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1127\" and arr_time>=1699085540917 and arr_time<1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1127\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1127\" AND arr_time >= 1699085540917 AND arr_time < 1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1127\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "DB": "data_center_dev",
        "Q": "总结2024年中，ACI Jet的总航班数量和飞行排名前三的区域。",
        "A": null,
        "SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1019\" and arr_time>=1699085540917 and arr_time<1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1019\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code    \n    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1019\" AND arr_time >= 1699085540917 AND arr_time < 1730707940917\n    GROUP BY b.supplier_id, d.en_name\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n        ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1019\" AND e.area_name IS NOT NULL AND arr_time >= 1699085540917 AND arr_time < 1730707940917\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_answer": null,
        "is_correct(SQL_judge)": "no"
    },
    {
        "DB": "data_center_dev",
        "Q": "总结2024年中，AEM Aviation的总航班数量和飞行排名前三的区域。",
        "A": null,
        "SQL": "WITH biao_1 AS (\n    SELECT\n        b.supplier_id,\n        d.en_name AS supplier_name,\n        COUNT(*) AS num\n    FROM deer.zts_plane_flight a\n    LEFT JOIN dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN dc_airport c ON a.dep_icao = c.icao_code    LEFT JOIN dc_supplier d ON b.supplier_id = d.id\n    WHERE b.supplier_id = \"1028\" and arr_time>=1699085540917 and arr_time<1730707940917\n),\n\nRankedAreas AS (\n    SELECT\n        e.area_name,\n        COUNT(*) AS flight_count,\n    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS rn\n    FROM deer.zts_plane_flight a\n    LEFT JOIN data_center_dev.dc_aircraft b ON LOWER(REPLACE(REPLACE(a.registration, ' ', ''), '-', '')) = LOWER(REPLACE(REPLACE(b.registration, ' ', ''), '-', ''))\n    LEFT JOIN data_center_dev.dc_airport c ON a.dep_icao = c.icao_code\n    LEFT JOIN data_center_dev.dc_country e ON c.country_id = e.id\n    WHERE b.supplier_id = \"1028\" AND e.area_name IS NOT NULL\n    GROUP BY e.area_name\n)\n\nSELECT\n    b1.supplier_id,\n    b1.supplier_name,\n    b1.num AS flight_count,\n    GROUP_CONCAT(ra.area_name ORDER BY ra.rn) AS top_areas\nFROM biao_1 b1\nLEFT JOIN RankedAreas ra ON TRUE\nWHERE ra.rn <= 3\nGROUP BY b1.supplier_id, b1.supplier_name, b1.num;",
        "actual_SQL": "",
        "actual_answer": null,
        "is_correct(SQL_judge)": "no"
    },
    {
        "correct_rate": 60.0,
        "sample_size": 5,
        "correct_count": 3
    }
]