[
    {
        "DB": "ai_database_dev",
        "Q": "列出2024年每月飞行次数最多的前10个机场，以及每个机场的起降航班数量。",
        "A": [
            [
                "2024-01",
                "KTEB",
                8797,
                1
            ],
            [
                "2024-01",
                "KPBI",
                6707,
                2
            ],
            [
                "2024-01",
                "KORD",
                6601,
                3
            ],
            [
                "2024-01",
                "KDAL",
                4779,
                4
            ],
            [
                "2024-01",
                "KLAS",
                4584,
                5
            ],
            [
                "2024-01",
                "KOPF",
                4274,
                6
            ],
            [
                "2024-01",
                "KSDL",
                4234,
                7
            ],
            [
                "2024-01",
                "KHOU",
                4107,
                8
            ],
            [
                "2024-01",
                "KVNY",
                4071,
                9
            ],
            [
                "2024-01",
                "KAPF",
                3830,
                10
            ],
            [
                "2024-02",
                "KTEB",
                8952,
                1
            ],
            [
                "2024-02",
                "KPBI",
                6789,
                2
            ],
            [
                "2024-02",
                "KORD",
                6566,
                3
            ],
            [
                "2024-02",
                "KLAS",
                5432,
                4
            ],
            [
                "2024-02",
                "KDAL",
                4821,
                5
            ],
            [
                "2024-02",
                "KSDL",
                4469,
                6
            ],
            [
                "2024-02",
                "KVNY",
                4393,
                7
            ],
            [
                "2024-02",
                "KOPF",
                4208,
                8
            ],
            [
                "2024-02",
                "KAPF",
                4066,
                9
            ],
            [
                "2024-02",
                "KHOU",
                3835,
                10
            ],
            [
                "2024-03",
                "KTEB",
                9787,
                1
            ],
            [
                "2024-03",
                "KPBI",
                7638,
                2
            ],
            [
                "2024-03",
                "KORD",
                7141,
                3
            ],
            [
                "2024-03",
                "KDAL",
                5082,
                4
            ],
            [
                "2024-03",
                "KSDL",
                4702,
                5
            ],
            [
                "2024-03",
                "KLAS",
                4346,
                6
            ],
            [
                "2024-03",
                "KOPF",
                4332,
                7
            ],
            [
                "2024-03",
                "KAPF",
                4278,
                8
            ],
            [
                "2024-03",
                "KIAD",
                4161,
                9
            ],
            [
                "2024-03",
                "KVNY",
                4161,
                10
            ],
            [
                "2024-04",
                "KTEB",
                10132,
                1
            ],
            [
                "2024-04",
                "KORD",
                8412,
                2
            ],
            [
                "2024-04",
                "KPBI",
                6328,
                3
            ],
            [
                "2024-04",
                "KDAL",
                5000,
                4
            ],
            [
                "2024-04",
                "KLAS",
                4662,
                5
            ],
            [
                "2024-04",
                "KIAD",
                4488,
                6
            ],
            [
                "2024-04",
                "KSDL",
                4319,
                7
            ],
            [
                "2024-04",
                "KVNY",
                4126,
                8
            ],
            [
                "2024-04",
                "KHOU",
                3808,
                9
            ],
            [
                "2024-04",
                "KHPN",
                3784,
                10
            ],
            [
                "2024-05",
                "KTEB",
                11488,
                1
            ],
            [
                "2024-05",
                "KORD",
                8247,
                2
            ],
            [
                "2024-05",
                "KDAL",
                5131,
                3
            ],
            [
                "2024-05",
                "KPBI",
                5015,
                4
            ],
            [
                "2024-05",
                "KLAS",
                4894,
                5
            ],
            [
                "2024-05",
                "KIAD",
                4756,
                6
            ],
            [
                "2024-05",
                "KVNY",
                4407,
                7
            ],
            [
                "2024-05",
                "KHPN",
                4119,
                8
            ],
            [
                "2024-05",
                "LFPB",
                3783,
                9
            ],
            [
                "2024-05",
                "KSDL",
                3779,
                10
            ],
            [
                "2024-06",
                "KTEB",
                8902,
                1
            ],
            [
                "2024-06",
                "KORD",
                8227,
                2
            ],
            [
                "2024-06",
                "KDAL",
                4737,
                3
            ],
            [
                "2024-06",
                "LFPB",
                4416,
                4
            ],
            [
                "2024-06",
                "KIAD",
                4079,
                5
            ],
            [
                "2024-06",
                "KLAS",
                3996,
                6
            ],
            [
                "2024-06",
                "KDEN",
                3789,
                7
            ],
            [
                "2024-06",
                "LFMN",
                3513,
                8
            ],
            [
                "2024-06",
                "KHPN",
                3453,
                9
            ],
            [
                "2024-06",
                "KVNY",
                3430,
                10
            ],
            [
                "2024-07",
                "KORD",
                7937,
                1
            ],
            [
                "2024-07",
                "KTEB",
                6866,
                2
            ],
            [
                "2024-07",
                "KDEN",
                4418,
                3
            ],
            [
                "2024-07",
                "LFMN",
                4412,
                4
            ],
            [
                "2024-07",
                "KDAL",
                4217,
                5
            ],
            [
                "2024-07",
                "LFPB",
                3578,
                6
            ],
            [
                "2024-07",
                "KHPN",
                3559,
                7
            ],
            [
                "2024-07",
                "KVNY",
                3501,
                8
            ],
            [
                "2024-07",
                "KLAS",
                3491,
                9
            ],
            [
                "2024-07",
                "KIAD",
                3149,
                10
            ],
            [
                "2024-08",
                "KORD",
                8199,
                1
            ],
            [
                "2024-08",
                "KTEB",
                6994,
                2
            ],
            [
                "2024-08",
                "KDAL",
                4384,
                3
            ],
            [
                "2024-08",
                "KDEN",
                4287,
                4
            ],
            [
                "2024-08",
                "KVNY",
                3810,
                5
            ],
            [
                "2024-08",
                "LFMN",
                3784,
                6
            ],
            [
                "2024-08",
                "KLAS",
                3783,
                7
            ],
            [
                "2024-08",
                "KHPN",
                3449,
                8
            ],
            [
                "2024-08",
                "KIAD",
                3032,
                9
            ],
            [
                "2024-08",
                "LFPB",
                3022,
                10
            ],
            [
                "2024-09",
                "KTEB",
                10947,
                1
            ],
            [
                "2024-09",
                "KORD",
                7645,
                2
            ],
            [
                "2024-09",
                "KDAL",
                5114,
                3
            ],
            [
                "2024-09",
                "KLAS",
                4815,
                4
            ],
            [
                "2024-09",
                "KIAD",
                4797,
                5
            ],
            [
                "2024-09",
                "KDEN",
                4270,
                6
            ],
            [
                "2024-09",
                "KVNY",
                3976,
                7
            ],
            [
                "2024-09",
                "KHPN",
                3880,
                8
            ],
            [
                "2024-09",
                "LFPB",
                3651,
                9
            ],
            [
                "2024-09",
                "LFMN",
                3370,
                10
            ],
            [
                "2024-10",
                "KTEB",
                7491,
                1
            ],
            [
                "2024-10",
                "KORD",
                5680,
                2
            ],
            [
                "2024-10",
                "KDAL",
                3825,
                3
            ],
            [
                "2024-10",
                "KLAS",
                3458,
                4
            ],
            [
                "2024-10",
                "KDEN",
                3045,
                5
            ],
            [
                "2024-10",
                "KIAD",
                3023,
                6
            ],
            [
                "2024-10",
                "LFPB",
                2827,
                7
            ],
            [
                "2024-10",
                "KVNY",
                2821,
                8
            ],
            [
                "2024-10",
                "KHPN",
                2764,
                9
            ],
            [
                "2024-10",
                "KPDK",
                2635,
                10
            ]
        ],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao,\n                count(*) AS dep_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n                AND a.dep_icao IS NOT NULL\n                AND a.dep_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.dep_icao\n        ),\n        biao_2 AS (\n        SELECT\n                a.date_month,\n                a.arr_icao,\n                count(*) AS arr_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n                AND a.arr_icao IS NOT NULL\n                AND a.arr_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.arr_icao\n        ),\n        biao_3 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao AS icao_code,\n                a.dep_num + b.arr_num AS total_num\n        FROM\n                biao_1 a\n                JOIN biao_2 b ON a.dep_icao = b.arr_icao\n                AND a.date_month = b.date_month\n        ) SELECT\n        *\nFROM\n        ( SELECT date_month, icao_code, total_num, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY total_num DESC ) AS rn FROM biao_3 ) g\nWHERE\n        g.rn <= 10",
        "actual_SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao,\n                count(*) AS dep_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n                AND a.dep_icao IS NOT NULL\n                AND a.dep_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.dep_icao\n        ),\n        biao_2 AS (\n        SELECT\n                a.date_month,\n                a.arr_icao,\n                count(*) AS arr_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n                AND a.arr_icao IS NOT NULL\n                AND a.arr_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.arr_icao\n        ),\n        biao_3 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao AS icao_code,\n                a.dep_num + b.arr_num AS total_num\n        FROM\n                biao_1 a\n                JOIN biao_2 b ON a.dep_icao = b.arr_icao\n                AND a.date_month = b.date_month\n        ) SELECT\n        *\nFROM\n        ( SELECT date_month, icao_code, total_num, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY total_num DESC ) AS rn FROM biao_3 ) g\nWHERE\n        g.rn <= 10",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "DB": "ai_database_dev",
        "Q": "列出2023年每月飞行次数最多的前10个机场，以及每个机场的起降航班数量。",
        "A": [
            [
                "2023-12",
                "KORD",
                109,
                1
            ],
            [
                "2023-12",
                "KPBI",
                89,
                2
            ],
            [
                "2023-12",
                "KDAL",
                85,
                3
            ],
            [
                "2023-12",
                "KTEB",
                83,
                4
            ],
            [
                "2023-12",
                "KNEW",
                64,
                5
            ],
            [
                "2023-12",
                "KLAS",
                60,
                6
            ],
            [
                "2023-12",
                "KASE",
                59,
                7
            ],
            [
                "2023-12",
                "KEGE",
                58,
                8
            ],
            [
                "2023-12",
                "KVNY",
                58,
                9
            ],
            [
                "2023-12",
                "KSDL",
                57,
                10
            ]
        ],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao,\n                count(*) AS dep_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2023-01'\n                AND '2023-12'\n                AND a.dep_icao IS NOT NULL\n                AND a.dep_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.dep_icao\n        ),\n        biao_2 AS (\n        SELECT\n                a.date_month,\n                a.arr_icao,\n                count(*) AS arr_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2023-01'\n                AND '2023-12'\n                AND a.arr_icao IS NOT NULL\n                AND a.arr_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.arr_icao\n        ),\n        biao_3 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao AS icao_code,\n                a.dep_num + b.arr_num AS total_num\n        FROM\n                biao_1 a\n                JOIN biao_2 b ON a.dep_icao = b.arr_icao\n                AND a.date_month = b.date_month\n        ) SELECT\n        *\nFROM\n        ( SELECT date_month, icao_code, total_num, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY total_num DESC ) AS rn FROM biao_3 ) g\nWHERE\n        g.rn <= 10",
        "actual_SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao,\n                count(*) AS dep_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2023-01'\n                AND '2023-12'\n                AND a.dep_icao IS NOT NULL\n                AND a.dep_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.dep_icao\n        ),\n        biao_2 AS (\n        SELECT\n                a.date_month,\n                a.arr_icao,\n                count(*) AS arr_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2023-01'\n                AND '2023-12'\n                AND a.arr_icao IS NOT NULL\n                AND a.arr_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.arr_icao\n        ),\n        biao_3 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao AS icao_code,\n                a.dep_num + b.arr_num AS total_num\n        FROM\n                biao_1 a\n                JOIN biao_2 b ON a.dep_icao = b.arr_icao\n                AND a.date_month = b.date_month\n        ) SELECT\n        *\nFROM\n        ( SELECT date_month, icao_code, total_num, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY total_num DESC ) AS rn FROM biao_3 ) g\nWHERE\n        g.rn <= 10",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "DB": "ai_database_dev",
        "Q": "列出2022年每月飞行次数最多的前10个机场，以及每个机场的起降航班数量。",
        "A": [],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao,\n                count(*) AS dep_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2022-01'\n                AND '2022-12'\n                AND a.dep_icao IS NOT NULL\n                AND a.dep_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.dep_icao\n        ),\n        biao_2 AS (\n        SELECT\n                a.date_month,\n                a.arr_icao,\n                count(*) AS arr_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2022-01'\n                AND '2022-12'\n                AND a.arr_icao IS NOT NULL\n                AND a.arr_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.arr_icao\n        ),\n        biao_3 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao AS icao_code,\n                a.dep_num + b.arr_num AS total_num\n        FROM\n                biao_1 a\n                JOIN biao_2 b ON a.dep_icao = b.arr_icao\n                AND a.date_month = b.date_month\n        ) SELECT\n        *\nFROM\n        ( SELECT date_month, icao_code, total_num, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY total_num DESC ) AS rn FROM biao_3 ) g\nWHERE\n        g.rn <= 10",
        "actual_SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao,\n                count(*) AS dep_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2022-01'\n                AND '2022-12'\n                AND a.dep_icao IS NOT NULL\n                AND a.dep_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.dep_icao\n        ),\n        biao_2 AS (\n        SELECT\n                a.date_month,\n                a.arr_icao,\n                count(*) AS arr_num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2022-01'\n                AND '2022-12'\n                AND a.arr_icao IS NOT NULL\n                AND a.arr_icao <> ''\n        GROUP BY\n                a.date_month,\n                a.arr_icao\n        ),\n        biao_3 AS (\n        SELECT\n                a.date_month,\n                a.dep_icao AS icao_code,\n                a.dep_num + b.arr_num AS total_num\n        FROM\n                biao_1 a\n                JOIN biao_2 b ON a.dep_icao = b.arr_icao\n                AND a.date_month = b.date_month\n        ) SELECT\n        *\nFROM\n        ( SELECT date_month, icao_code, total_num, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY total_num DESC ) AS rn FROM biao_3 ) g\nWHERE\n        g.rn <= 10",
        "actual_answer": null,
        "is_correct(SQL_judge)": "yes"
    },
    {
        "correct_rate": 100.0,
        "sample_size": 3,
        "correct_count": 3
    }
]