[
    {
        "DB": "ai_database_dev",
        "Q": "列出2022年每月飞行次数最多的前10个的国家，并提供环比变化。",
        "A": [],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_country_name,\n                count(*) AS num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2022-01'\n                AND '2022-12'\n                AND a.dep_country_name IS NOT NULL\n        GROUP BY\n                a.date_month,\n                a.dep_country_name\n        ),\n        biao_2 AS ( SELECT *, lag( num ) over ( PARTITION BY dep_country_name ORDER BY date_month ) AS last_num FROM biao_1 ),\n        biao_3 AS ( SELECT *, concat( round(( num - last_num )/ last_num * 100, 2 ), '%' ) AS rate FROM biao_2 ),\n        biao_4 AS ( SELECT *, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY num DESC ) AS rn FROM biao_3 ) SELECT\n        date_month,\n        dep_country_name,\n        num,\n        last_num,\n        rate\nFROM\n        biao_4\nWHERE\n        rn <= 10\n        AND last_num IS NOT NULL;"
    },
    {
        "DB": "ai_database_dev",
        "Q": "列出2023年每月飞行次数最多的前10个的国家，并提供环比变化。",
        "A": [
            [
                "2023-05",
                "United States",
                1,
                3,
                "-66.67%"
            ],
            [
                "2023-06",
                "United States",
                1,
                1,
                "0.00%"
            ],
            [
                "2023-07",
                "United States",
                1,
                1,
                "0.00%"
            ],
            [
                "2023-08",
                "United States",
                4,
                1,
                "300.00%"
            ],
            [
                "2023-09",
                "United States",
                5,
                4,
                "25.00%"
            ],
            [
                "2023-09",
                "Mexico",
                1,
                2,
                "-50.00%"
            ],
            [
                "2023-10",
                "Singapore",
                1,
                1,
                "0.00%"
            ],
            [
                "2023-10",
                "United States",
                1,
                5,
                "-80.00%"
            ],
            [
                "2023-12",
                "United States",
                1933,
                1,
                "193200.00%"
            ],
            [
                "2023-12",
                "Mexico",
                63,
                1,
                "6200.00%"
            ],
            [
                "2023-12",
                "Canada",
                36,
                1,
                "3500.00%"
            ],
            [
                "2023-12",
                "Brazil",
                19,
                1,
                "1800.00%"
            ],
            [
                "2023-12",
                "France",
                8,
                1,
                "700.00%"
            ]
        ],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_country_name,\n                count(*) AS num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2023-01'\n                AND '2023-12'\n                AND a.dep_country_name IS NOT NULL\n        GROUP BY\n                a.date_month,\n                a.dep_country_name\n        ),\n        biao_2 AS ( SELECT *, lag( num ) over ( PARTITION BY dep_country_name ORDER BY date_month ) AS last_num FROM biao_1 ),\n        biao_3 AS ( SELECT *, concat( round(( num - last_num )/ last_num * 100, 2 ), '%' ) AS rate FROM biao_2 ),\n        biao_4 AS ( SELECT *, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY num DESC ) AS rn FROM biao_3 ) SELECT\n        date_month,\n        dep_country_name,\n        num,\n        last_num,\n        rate\nFROM\n        biao_4\nWHERE\n        rn <= 10\n        AND last_num IS NOT NULL;"
    },
    {
        "DB": "ai_database_dev",
        "Q": "列出2024年每月飞行次数最多的前10个的国家，并提供环比变化。",
        "A": [
            [
                "2024-02",
                "United States",
                157726,
                150338,
                "4.91%"
            ],
            [
                "2024-02",
                "Canada",
                5534,
                5022,
                "10.20%"
            ],
            [
                "2024-02",
                "Mexico",
                5532,
                6939,
                "-20.28%"
            ],
            [
                "2024-02",
                "Brazil",
                4766,
                4174,
                "14.18%"
            ],
            [
                "2024-02",
                "France",
                4404,
                4106,
                "7.26%"
            ],
            [
                "2024-02",
                "United Kingdom",
                4260,
                3815,
                "11.66%"
            ],
            [
                "2024-02",
                "Germany",
                3731,
                3480,
                "7.21%"
            ],
            [
                "2024-02",
                "Switzerland",
                2894,
                3039,
                "-4.77%"
            ],
            [
                "2024-02",
                "Italy",
                2529,
                2280,
                "10.92%"
            ],
            [
                "2024-02",
                "Spain",
                2359,
                2508,
                "-5.94%"
            ],
            [
                "2024-03",
                "United States",
                168740,
                157726,
                "6.98%"
            ],
            [
                "2024-03",
                "Mexico",
                7040,
                5532,
                "27.26%"
            ],
            [
                "2024-03",
                "Canada",
                5500,
                5534,
                "-0.61%"
            ],
            [
                "2024-03",
                "Brazil",
                5175,
                4766,
                "8.58%"
            ],
            [
                "2024-03",
                "France",
                4902,
                4404,
                "11.31%"
            ],
            [
                "2024-03",
                "United Kingdom",
                4517,
                4260,
                "6.03%"
            ],
            [
                "2024-03",
                "Germany",
                4029,
                3731,
                "7.99%"
            ],
            [
                "2024-03",
                "Italy",
                3010,
                2529,
                "19.02%"
            ],
            [
                "2024-03",
                "Spain",
                2949,
                2359,
                "25.01%"
            ],
            [
                "2024-03",
                "Switzerland",
                2800,
                2894,
                "-3.25%"
            ],
            [
                "2024-04",
                "United States",
                166070,
                168740,
                "-1.58%"
            ],
            [
                "2024-04",
                "Mexico",
                6251,
                7040,
                "-11.21%"
            ],
            [
                "2024-04",
                "Canada",
                5415,
                5500,
                "-1.55%"
            ],
            [
                "2024-04",
                "Brazil",
                5046,
                5175,
                "-2.49%"
            ],
            [
                "2024-04",
                "France",
                4786,
                4902,
                "-2.37%"
            ],
            [
                "2024-04",
                "United Kingdom",
                4283,
                4517,
                "-5.18%"
            ],
            [
                "2024-04",
                "Germany",
                4074,
                4029,
                "1.12%"
            ],
            [
                "2024-04",
                "Italy",
                3740,
                3010,
                "24.25%"
            ],
            [
                "2024-04",
                "Spain",
                3494,
                2949,
                "18.48%"
            ],
            [
                "2024-04",
                "Switzerland",
                2275,
                2800,
                "-18.75%"
            ],
            [
                "2024-05",
                "United States",
                171616,
                166070,
                "3.34%"
            ],
            [
                "2024-05",
                "France",
                6825,
                4786,
                "42.60%"
            ],
            [
                "2024-05",
                "Canada",
                6140,
                5415,
                "13.39%"
            ],
            [
                "2024-05",
                "Mexico",
                5939,
                6251,
                "-4.99%"
            ],
            [
                "2024-05",
                "United Kingdom",
                5601,
                4283,
                "30.77%"
            ],
            [
                "2024-05",
                "Brazil",
                4947,
                5046,
                "-1.96%"
            ],
            [
                "2024-05",
                "Italy",
                4892,
                3740,
                "30.80%"
            ],
            [
                "2024-05",
                "Germany",
                4434,
                4074,
                "8.84%"
            ],
            [
                "2024-05",
                "Spain",
                4037,
                3494,
                "15.54%"
            ],
            [
                "2024-05",
                "Switzerland",
                2745,
                2275,
                "20.66%"
            ],
            [
                "2024-06",
                "United States",
                151108,
                171616,
                "-11.95%"
            ],
            [
                "2024-06",
                "France",
                7674,
                6825,
                "12.44%"
            ],
            [
                "2024-06",
                "Canada",
                6425,
                6140,
                "4.64%"
            ],
            [
                "2024-06",
                "United Kingdom",
                6161,
                5601,
                "10.00%"
            ],
            [
                "2024-06",
                "Italy",
                5441,
                4892,
                "11.22%"
            ],
            [
                "2024-06",
                "Germany",
                5229,
                4434,
                "17.93%"
            ],
            [
                "2024-06",
                "Spain",
                4526,
                4037,
                "12.11%"
            ],
            [
                "2024-06",
                "Mexico",
                4485,
                5939,
                "-24.48%"
            ],
            [
                "2024-06",
                "Brazil",
                4415,
                4947,
                "-10.75%"
            ],
            [
                "2024-06",
                "Switzerland",
                3018,
                2745,
                "9.95%"
            ],
            [
                "2024-07",
                "United States",
                155646,
                151108,
                "3.00%"
            ],
            [
                "2024-07",
                "France",
                8139,
                7674,
                "6.06%"
            ],
            [
                "2024-07",
                "Italy",
                6633,
                5441,
                "21.91%"
            ],
            [
                "2024-07",
                "United Kingdom",
                6428,
                6161,
                "4.33%"
            ],
            [
                "2024-07",
                "Canada",
                6330,
                6425,
                "-1.48%"
            ],
            [
                "2024-07",
                "Spain",
                5228,
                4526,
                "15.51%"
            ],
            [
                "2024-07",
                "Germany",
                5001,
                5229,
                "-4.36%"
            ],
            [
                "2024-07",
                "Mexico",
                4371,
                4485,
                "-2.54%"
            ],
            [
                "2024-07",
                "Brazil",
                3918,
                4415,
                "-11.26%"
            ],
            [
                "2024-07",
                "Switzerland",
                2795,
                3018,
                "-7.39%"
            ],
            [
                "2024-08",
                "United States",
                155160,
                155646,
                "-0.31%"
            ],
            [
                "2024-08",
                "France",
                6637,
                8139,
                "-18.45%"
            ],
            [
                "2024-08",
                "Canada",
                6443,
                6330,
                "1.79%"
            ],
            [
                "2024-08",
                "Italy",
                5196,
                6633,
                "-21.66%"
            ],
            [
                "2024-08",
                "United Kingdom",
                5149,
                6428,
                "-19.90%"
            ],
            [
                "2024-08",
                "Mexico",
                4808,
                4371,
                "10.00%"
            ],
            [
                "2024-08",
                "Brazil",
                4621,
                3918,
                "17.94%"
            ],
            [
                "2024-08",
                "Spain",
                4156,
                5228,
                "-20.50%"
            ],
            [
                "2024-08",
                "Germany",
                3658,
                5001,
                "-26.85%"
            ],
            [
                "2024-08",
                "Switzerland",
                2540,
                2795,
                "-9.12%"
            ],
            [
                "2024-09",
                "United States",
                159886,
                155160,
                "3.05%"
            ],
            [
                "2024-09",
                "France",
                6470,
                6637,
                "-2.52%"
            ],
            [
                "2024-09",
                "Canada",
                5886,
                6443,
                "-8.65%"
            ],
            [
                "2024-09",
                "United Kingdom",
                5582,
                5149,
                "8.41%"
            ],
            [
                "2024-09",
                "Italy",
                4956,
                5196,
                "-4.62%"
            ],
            [
                "2024-09",
                "Mexico",
                4640,
                4808,
                "-3.49%"
            ],
            [
                "2024-09",
                "Germany",
                4597,
                3658,
                "25.67%"
            ],
            [
                "2024-09",
                "Brazil",
                4416,
                4621,
                "-4.44%"
            ],
            [
                "2024-09",
                "Spain",
                4205,
                4156,
                "1.18%"
            ],
            [
                "2024-09",
                "Switzerland",
                2874,
                2540,
                "13.15%"
            ],
            [
                "2024-10",
                "United States",
                120321,
                159886,
                "-24.75%"
            ],
            [
                "2024-10",
                "France",
                3823,
                6470,
                "-40.91%"
            ],
            [
                "2024-10",
                "Canada",
                3691,
                5886,
                "-37.29%"
            ],
            [
                "2024-10",
                "United Kingdom",
                3683,
                5582,
                "-34.02%"
            ],
            [
                "2024-10",
                "Mexico",
                3478,
                4640,
                "-25.04%"
            ],
            [
                "2024-10",
                "Germany",
                3020,
                4597,
                "-34.30%"
            ],
            [
                "2024-10",
                "Italy",
                2937,
                4956,
                "-40.74%"
            ],
            [
                "2024-10",
                "Brazil",
                2788,
                4416,
                "-36.87%"
            ],
            [
                "2024-10",
                "Spain",
                2777,
                4205,
                "-33.96%"
            ],
            [
                "2024-10",
                "Switzerland",
                1755,
                2874,
                "-38.94%"
            ]
        ],
        "SQL": "WITH biao_1 AS (\n        SELECT\n                a.date_month,\n                a.dep_country_name,\n                count(*) AS num\n        FROM\n                zts_plane_flight_1 a\n                JOIN avigo_nlp_dev.ai_target_jet b ON a.pure_reg = b.pure_reg\n        WHERE\n                a.date_month BETWEEN '2024-01'\n                AND '2024-12'\n                AND a.dep_country_name IS NOT NULL\n        GROUP BY\n                a.date_month,\n                a.dep_country_name\n        ),\n        biao_2 AS ( SELECT *, lag( num ) over ( PARTITION BY dep_country_name ORDER BY date_month ) AS last_num FROM biao_1 ),\n        biao_3 AS ( SELECT *, concat( round(( num - last_num )/ last_num * 100, 2 ), '%' ) AS rate FROM biao_2 ),\n        biao_4 AS ( SELECT *, ROW_NUMBER() over ( PARTITION BY date_month ORDER BY num DESC ) AS rn FROM biao_3 ) SELECT\n        date_month,\n        dep_country_name,\n        num,\n        last_num,\n        rate\nFROM\n        biao_4\nWHERE\n        rn <= 10\n        AND last_num IS NOT NULL;"
    }
]